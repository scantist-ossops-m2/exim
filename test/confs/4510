# Exim test configuration 4510

SERVER=
OPT=

exim_path = EXIM_PATH
keep_environment =
host_lookup_order = bydns
spool_directory = DIR/spool

.ifdef SERVER
log_file_path = DIR/spool/log/SERVER%slog
.else
log_file_path = DIR/spool/log/%slog
.endif

gecos_pattern = ""
gecos_name = CALLER_NAME
tls_advertise_hosts =


primary_hostname = myhost.test.ex

# ----- Main settings -----

acl_smtp_rcpt = accept
acl_smtp_dkim = accept logwrite = signer: $dkim_cur_signer bits: h=$dkim_headernames
acl_smtp_data_prdr = accept local_parts = okuser

prdr_enable

# ----- Routers

begin routers

client:
  driver = accept
  condition = ${if eq {SERVER}{server}{no}{yes}}
  transport = send_to_server

server_dump:
  driver = redirect
  senders = ! :
  data = :blackhole:

server_store:
  driver = accept
  transport = store

# ----- Transports

begin transports

store:
  driver = appendfile
  file = DIR/test-mail/store
  return_path_add
  user = CALLER

send_to_server:
  driver = smtp
  allow_localhost
  hosts = HOSTIPV4
  port = PORT_D

  dkim_domain =		${if def:sender_address_local_part {test.ex}}
  dkim_selector =	sel
  dkim_private_key =	DIR/aux-fixed/dkim/dkim.private
  dkim_sign_headers =	From

# End
